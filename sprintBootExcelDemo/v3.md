å¥½ï¼Œä¸‹é¢æˆ‘**ç›´æ¥ç”¨å¯¦å‹™æƒ…å¢ƒç¤ºç¯„ã€Œå†å¡ä¸€å€‹ ExcelSheetMetaã€**ï¼Œè®“ä½ ä¸€çœ¼çœ‹å‡º **å¤š Sheet çš„çœŸæ­£åƒ¹å€¼**ï¼Œä¸æ˜¯ç‚ºäº†ç‚«æŠ€è€Œå·²ã€‚

---

## æƒ…å¢ƒè¨­å®šï¼ˆå¾ˆçœŸå¯¦ï¼‰

ä½ ç¾åœ¨è¦åŒ¯å‡ºä¸€å€‹ **report.xlsx**ï¼Œå…§å®¹åŒ…å«ï¼š

1ï¸âƒ£ **ä½¿ç”¨è€…æ¸…å–®ï¼ˆUsersï¼‰**
2ï¸âƒ£ **ä½¿ç”¨è€…çµ±è¨ˆï¼ˆSummaryï¼‰**

ğŸ‘‰ **åŒä¸€å€‹æª”æ¡ˆã€å…©å¼µ Sheetã€ä¸åŒè³‡æ–™çµæ§‹**

---

# ä¸€ã€ç¬¬äºŒå€‹è³‡æ–™æ¨¡å‹ï¼ˆå®Œå…¨ä¸åŒçµæ§‹ï¼‰

```java
public class UserSummary {

    @ExcelColumn(header = "ç¸½äººæ•¸", order = 1)
    private int totalUsers;

    @ExcelColumn(header = "å•Ÿç”¨å¸³è™Ÿæ•¸", order = 2)
    private int activeUsers;

    @ExcelColumn(header = "ç”¢ç”Ÿæ™‚é–“", order = 3, format = "yyyy-MM-dd HH:mm")
    private LocalDateTime generatedAt;

    // constructor / getter
}
```

ğŸ“Œ é‡é»ï¼š

* **ä¸åŒ Entity**
* **ä¸åŒæ¬„ä½**
* **åŒä¸€å€‹ Excel æª”æ¡ˆ**

---

# äºŒã€Controllerï¼šä¸€æ¬¡å¡å…©å€‹ ExcelSheetMetaï¼ˆé—œéµï¼‰

```java
@GetMapping("/export")
public void exportReport(HttpServletResponse response) throws IOException {

    // Sheet 1ï¼šä½¿ç”¨è€…æ¸…å–®
    List<User> users = userService.findAllUsers();

    ExcelSheetMeta<User> userSheet =
        new ExcelSheetMeta<>(
            "Users",
            users,
            User.class,
            Set.of("id", "name", "email") // å‹•æ…‹æ¬„ä½
        );

    // Sheet 2ï¼šçµ±è¨ˆè³‡æ–™ï¼ˆåªæœ‰ä¸€ç­†ï¼‰
    UserSummary summary =
        new UserSummary(
            users.size(),
            users.size() - 2,
            LocalDateTime.now()
        );

    ExcelSheetMeta<UserSummary> summarySheet =
        new ExcelSheetMeta<>(
            "Summary",
            List.of(summary),
            UserSummary.class,
            null // å…¨æ¬„ä½
        );

    excelExportService.export(
        "report.xlsx",
        List.of(userSheet, summarySheet),
        response
    );
}
```

---

# ä¸‰ã€ç”¢å‡ºçµæœé•·æ€æ¨£ï¼Ÿï¼ˆä½ è…¦ä¸­è¦æœ‰ç•«é¢ï¼‰

### ğŸ“„ report.xlsx

```
|-- Sheet: Users
|   ID | å§“å | Email
|   1  | Tom  | tom@test.com
|   2  | Mary | mary@test.com
|
|-- Sheet: Summary
|   ç¸½äººæ•¸ | å•Ÿç”¨å¸³è™Ÿæ•¸ | ç”¢ç”Ÿæ™‚é–“
|   2      | 0          | 2026-02-11 14:30
```

---

# å››ã€é€™å€‹ã€Œå†å¡ä¸€å€‹ Sheetã€çš„å¯¦éš›åƒ¹å€¼

## âœ… 1. å•†æ¥­é‚è¼¯å®Œå…¨ä¸ç”¨æ”¹

```java
userService.findAllUsers();
```

æ²’æœ‰ä»»ä½•ã€Œç‚ºäº† Excelã€çš„ if / else

---

## âœ… 2. æ¯å€‹ Sheet å¯ä»¥ï¼š

* ä¸åŒ Entity
* ä¸åŒæ¬„ä½
* ä¸åŒæ¬„ä½é–‹é—œ
* ä¸åŒè³‡æ–™é‡

ğŸ‘‰ **ExcelExportTemplate å®Œå…¨ä¸ç”¨å‹•**

---

## âœ… 3. è¶…é©åˆé€™äº›ä¼æ¥­éœ€æ±‚

* ä¸»è³‡æ–™ + çµ±è¨ˆ
* æ˜ç´° + å°è¨ˆ + ç¸½è¨ˆ
* å¤šæ¨¡çµ„å ±è¡¨ï¼ˆHR / Finance / Opsï¼‰
* å°å®¢æˆ¶äº¤ä»˜ã€Œä¸€åŒ…å®Œæ•´å ±å‘Šã€

---

# äº”ã€å¦‚æœä½ ä¸ç”¨å¤š Sheetï¼Œæœƒç™¼ç”Ÿä»€éº¼äº‹ï¼Ÿ

âŒ ä½ æœƒï¼š

* Controller å¯«çˆ†
* POI ç›´æ¥å¯«åœ¨ Controller
* ç‚ºæ¯ç¨®å ±è¡¨è¤‡è£½ä¸€ä»½åŒ¯å‡ºç¨‹å¼
* æ¯åŠ ä¸€å€‹ Sheet å°±è¤‡è£½è²¼ä¸Š

âœ”ï¸ ç¾åœ¨ï¼š

* **åªå¤šä¸€å€‹ ExcelSheetMeta**
* Template ä¸€è¡Œä¸æ”¹

---

# å…­ã€è€æ‰‹ç¸½çµä¸€å¥è©±

> **ExcelSheetMeta çš„åƒ¹å€¼ä¸æ˜¯ã€Œå¤šä¸€å¼µ Sheetã€**
> **è€Œæ˜¯ã€Œä¸€å€‹ Excel = å¤šå€‹å•†æ¥­è¦–è§’çš„é›†åˆã€**

---

## ä¸‹ä¸€æ­¥æˆ‘å¯ä»¥å†å¹«ä½ å‡ç´šåˆ°ï¼š

* Sheet ä¹‹é–“å…±ç”¨æ¨£å¼
* Summary è‡ªå‹•è¨ˆç®—ï¼ˆä¸é  Serviceï¼‰
* æ¯å€‹ Sheet ä¸åŒ Template
* åŒ¯å‡ºè¨­å®š JSON åŒ–ï¼ˆå‰ç«¯æ§åˆ¶æ¬„ä½ï¼‰

ä½ åªè¦èªªï¼š
ğŸ‘‰ã€Œ**æˆ‘æƒ³çœ‹å“ªä¸€å€‹å†é€²éš**ã€
